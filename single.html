<!DOCTYPE html>

<html lang="en" class="no-js">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>trang chi tiết </title>
    <link href="css/styles.css" rel="stylesheet" type="text/css"/>
    <link href="css/media_query.css" rel="stylesheet" type="text/css"/>
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
          integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="css/animate.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
    <link href="css/owl.carousel.css" rel="stylesheet" type="text/css"/>
    <link href="css/owl.theme.default.css" rel="stylesheet" type="text/css"/>
    <!-- Bootstrap CSS -->
    <link href="css/style_1.css" rel="stylesheet" type="text/css"/>
    <!-- Modernizr JS -->
    <script src="js/modernizr-3.5.0.min.js"></script>
</head>
<body class="single">
<!-- Header -->
<div id="header-placeholder"></div>

<div id="fh5co-title-box" style="background-image: url(images/camila-cordeiro-114636.jpg); background-position: 50% 90.5px;" data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="page-title">
        <span id="article-date">thời gian</span>
        <h2 id="article-title">tiêu đề</h2>
    </div>
</div>
<div id="fh5co-single-content" class="container-fluid pb-4 pt-4 paddding">
    <div class="container paddding">
        <div class="row mx-0">
            <h1 id="article-mota"></h1>

            <p id="article-content">
                Đây là nội dung chi tiết của bài viết. Nội dung này sẽ được thay thế bằng dữ liệu thực tế từ cơ sở dữ liệu hoặc API.
            </p>

            <div style="display: flex; justify-content: space-between; width: 100%;">
                <p class="font-italic" id="article-soluocxem">Số lần xem: 123</p>
                <p class="font-italic" id="article-author">Tác giả: Nguyễn Văn A</p>
            </div> 
        </div>
    </div>
</div>

        <!-- Comment Section -->
        <div class="row mt-5">
            <div class="col-md-12">
                <h3>Khu Bình Luận</h3>
                <form id="comment-form" class="mb-4">
                    <div class="form-group">
                        <label for="comment-content">Bình luận</label>
                        <textarea class="form-control" id="comment-content" rows="3" placeholder="Nhập bình luận của bạn" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" id="submit-comment" disabled>Gửi Bình Luận</button>
                    <p class="text-danger mt-2" id="login-warning" style="display: none;">Bạn cần đăng nhập để bình luận.</p>
                </form>
                <div id="comments-list">
                    <!-- khu bình luận -->
                </div>
            </div>
        </div>        


<!-- footer -->
<div class="container-fluid fh5co_footer_bg pb-3">
    <div class="container animate-box">
        <div class="row">
            <div class="col-12 spdp_right py-5"></div>
            <div class="clearfix"></div>
            <div class="col-12 col-md-4 col-lg-3">
                <div class="footer_main_title py-3"> địa chỉ </div>
                <div class="footer_sub_about pb-3"> số 123, bình chánh ấp 5, huyện phong phú, tp.Hồ Chí Minh
                </div>
                
            </div>
        </div>
    </div>
</div>
<div class="container-fluid fh5co_footer_right_reserved">
    <div class="container">
        <div class="row  ">
            <div class="col-12 col-md-6 py-4 Reserved"> <a href="index.html" title="Free HTML5 Bootstrap templates"> nhóm 21</a>. </div>
            <div class="col-12 col-md-6 spdp_right py-4">
                <a href="index.html" class="footer_last_part_menu">trang chủ</a>
            
        </div>
    </div>
</div>

<div class="gototop js-top">
    <a href="#" class="js-gotop"><i class="fa fa-arrow-up"></i></a>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="js/owl.carousel.min.js"></script>
<!--<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"
        integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"
        integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"
        crossorigin="anonymous"></script>
<!-- Waypoints -->
<script src="js/jquery.waypoints.min.js"></script>
<!-- Parallax -->
<script src="js/jquery.stellar.min.js"></script>
<!-- Main -->
<script src="js/main.js"></script>
<script>if (!navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)){$(window).stellar();}</script>

<!-- scrip bên chi tiet  -->
<script>
    $(document).ready(function(){
        $("#header-placeholder").load("header.html");

        // Function to get query parameters from the URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        const idTin = getQueryParam("idTin"); // Extract idTin from the URL
        const apiUrl = `http://nguyenquocdai-001-site1.ltempurl.com/api/tin/${idTin}`;
        const commentsApiUrl = `http://nguyenquocdai-001-site1.ltempurl.com/api/binhluan/${idTin}`;

        // Fetch article data from the API
        $.getJSON(apiUrl, function(data) {
    console.log("Dữ liệu API:", data); // Debug log

    if (data && data.tieuDe) {
        const article = data;

        $("#article-title").text(article.tieuDe || "No Title");
        $("#article-date").text(`Ngày đăng: ${article.ngayDangTin || "N/A"}`);
        $("#article-content").text(article.noiDung || "không có nội dung");
        $("#article-mota").text(article.moTa || "không có mô tả");
        $("#article-author").text(article.tacGia || "N/A");
        $("#article-soluocxem").text(article.soLanXem || 0);
        $("#fh5co-title-box").css("background-image", `url(${article.hinhDaiDien || 'https://via.placeholder.com/150'})`);
    } else {
        alert("Không tìm thấy bài viết!");
    }
}).fail(function() {
    console.error("Failed to fetch article data.");
});

        // Fetch comments data from the API
        $.getJSON(commentsApiUrl, function(comments) {
            if (comments && comments.length > 0) {
                comments.forEach(comment => {
                    const commenterName = comment.nguoiBinhLuan.split("@")[0]; // Extract name before "@"
                    const commentHtml = `
                        <div class="border p-3 mb-3">
                            <h5>
                                ${commenterName}
                                <small class="text-muted float-right">${new Date(comment.thoiGian).toLocaleString("vi-VN")}</small>
                            </h5>
                            <p>${comment.noiDung}</p>
                        </div>
                    `;
                    $("#comments-list").append(commentHtml);
                });
            }
        }).fail(function() {
            console.error("Failed to fetch comments data.");
            // alert("Không thể tải dữ liệu bình luận!");
        });

        // Check if the user is logged in
        const isLoggedIn = false; // Replace with actual login check logic
        if (!isLoggedIn) {
            $("#submit-comment").prop("disabled", true);
            $("#login-warning").show();
        }

        // Handle comment submission
        $("#comment-form").submit(function(e) {
            e.preventDefault();
            if (!isLoggedIn) {
                alert("Bạn cần đăng nhập để bình luận.");
                return;
            }
            const content = $("#comment-content").val();
            const currentDate = new Date().toLocaleString("vi-VN");

            if (content) {
                const commentHtml = `
                    <div class="border p-3 mb-3">
                        <h5>Người dùng <small class="text-muted">${currentDate}</small></h5>
                        <p>${content}</p>
                    </div>
                `;
                $("#comments-list").append(commentHtml);
                $("#comment-form")[0].reset();
            }
        });
    });
</script>
</body>
</html>