<!DOCTYPE html>

<html lang="en" class="no-js">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>nhóm 21 trang chủ</title>
    <link href="css/styles.css" rel="stylesheet" type="text/css"/>

    <link href="css/media_query.css" rel="stylesheet" type="text/css"/>
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
          integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="css/animate.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
    <link href="css/owl.carousel.css" rel="stylesheet" type="text/css"/>
    <link href="css/owl.theme.default.css" rel="stylesheet" type="text/css"/>
    <!-- Bootstrap CSS -->
    <link href="css/style_1.css" rel="stylesheet" type="text/css"/>
    <!-- Modernizr JS -->
    <script src="js/modernizr-3.5.0.min.js"></script>
    
</head>
<body>
<div id ="header-placeholder">
    <!-- header -->
</div>
<div class="container-fluid bg-faded fh5co_padd_mediya padding_786">
    <div class="container padding_786">
        <nav class="navbar navbar-toggleable-md navbar-light ">
            <button class="navbar-toggler navbar-toggler-right mt-3" type="button" data-toggle="collapse"
                    data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                    aria-label="Toggle navigation"><span class="fa fa-bars"></span></button>
            <a class="navbar-brand" href="#"><img src="images/logo.png" alt="img" class="mobile_logo_width"/></a>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto" id ="menu-container">

                </ul>
            </div>
        </nav>
    </div>
</div>
<div class="container-fluid pb-4 pt-4 paddding">
    <div class="container paddding">
        <div class="row mx-0">
            <div class="col-md-8 animate-box" data-animate-effect="fadeInLeft">
                <div>
                    <div class="fh5co_heading fh5co_heading_border_bottom py-2 mb-4">tin tức</div>
                </div>
                <div id="news-container" class="row pb-4">
                    <!-- tin tức ở đây -->
                    
                </div>
            </div>
            <div class="col-md-3 animate-box" data-animate-effect="fadeInRight">
                <div>
                    <div class="fh5co_heading fh5co_heading_border_bottom py-2 mb-4">Tags</div>
                </div>
                <div class="clearfix"></div>
                <div class="fh5co_tags_all">
                    <a href="#" class="fh5co_tagg">Business</a>
                    <a href="#" class="fh5co_tagg">Technology</a>
                    <a href="#" class="fh5co_tagg">Sport</a>
                    <a href="#" class="fh5co_tagg">Art</a>
                    <a href="#" class="fh5co_tagg">Lifestyle</a>
                    <a href="#" class="fh5co_tagg">Three</a>
                    <a href="#" class="fh5co_tagg">Photography</a>
                    <a href="#" class="fh5co_tagg">Lifestyle</a>
                    <a href="#" class="fh5co_tagg">Art</a>
                    <a href="#" class="fh5co_tagg">Education</a>
                    <a href="#" class="fh5co_tagg">Social</a>
                    <a href="#" class="fh5co_tagg">Three</a>
                </div>

                <div>
                    <div class="fh5co_heading fh5co_heading_border_bottom pt-3 py-2 mb-4">được xem nhiều</div>
                </div>
                <div class="row pb-3">
                    <div class="col-5 align-self-center">
                        <img src="images/download (1).jpg" alt="img" class="fh5co_most_trading"/>
                    </div>
                    <div class="col-7 paddding">
                        <div class="most_fh5co_treding_font"> Magna aliqua ut enim ad minim veniam quis nostrud.</div>
                        <div class="most_fh5co_treding_font_123"> April 18, 2016</div>
                    </div>
                </div>

            </div>
        </div>
        <div class="row mx-0 animate-box" data-animate-effect="fadeInUp">
            <div class="col-12 text-center pb-4 pt-4">
                <a href="#" class="btn_mange_pagging"><i class="fa fa-long-arrow-left"></i>&nbsp;&nbsp; Previous</a>
                <a href="#" class="btn_pagging">1</a>
                <a href="#" class="btn_pagging">2</a>
                <a href="#" class="btn_pagging">3</a>
                <a href="#" class="btn_pagging">...</a>
                <a href="#" class="btn_mange_pagging">Next <i class="fa fa-long-arrow-right"></i>&nbsp;&nbsp; </a>
             </div>
        </div>
    </div>
</div>
<!-- footer -->
<div class="container-fluid fh5co_footer_bg pb-3">
    <div class="container animate-box">
        <div class="row">
            <div class="col-12 spdp_right py-5"></div>
            <div class="clearfix"></div>
            <div class="col-12 col-md-4 col-lg-3">
                <div class="footer_main_title py-3"> địa chỉ </div>
                <div class="footer_sub_about pb-3"> số 123, bình chánh ấp 5, huyện phong phú, tp.Hồ Chí Minh
                </div>
                <!-- <div class="footer_mediya_icon">
                    <div class="text-center d-inline-block"><a class="fh5co_display_table_footer">
                        <div class="fh5co_verticle_middle"><i class="fa fa-linkedin"></i></div>
                    </a></div>
                    <div class="text-center d-inline-block"><a class="fh5co_display_table_footer">
                        <div class="fh5co_verticle_middle"><i class="fa fa-google-plus"></i></div>
                    </a></div>
                    <div class="text-center d-inline-block"><a class="fh5co_display_table_footer">
                        <div class="fh5co_verticle_middle"><i class="fa fa-twitter"></i></div>
                    </a></div>
                    <div class="text-center d-inline-block"><a class="fh5co_display_table_footer">
                        <div class="fh5co_verticle_middle"><i class="fa fa-facebook"></i></div>
                    </a></div>
                </div> -->
            </div>
            <!-- <div class="col-12 col-md-3 col-lg-2">
                <div class="footer_main_title py-3"> Category</div>
                <ul class="footer_menu">
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; Business</a></li>
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; Entertainment</a></li>
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; Environment</a></li>
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; Health</a></li>
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; Life style</a></li>
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; Politics</a></li>
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; Technology</a></li>
                    <li><a href="#" class=""><i class="fa fa-angle-right"></i>&nbsp;&nbsp; World</a></li>
                </ul>
            </div> -->
            <!-- <div class="col-12 col-md-5 col-lg-3 position_footer_relative">
                <div class="footer_main_title py-3"> Most Viewed Posts</div>
                <div class="footer_makes_sub_font"> Dec 31, 2016</div>
                <a href="#" class="footer_post pb-4"> Success is not a good teacher failure makes you humble </a>
                <div class="footer_makes_sub_font"> Dec 31, 2016</div>
                <a href="#" class="footer_post pb-4"> Success is not a good teacher failure makes you humble </a>
                <div class="footer_makes_sub_font"> Dec 31, 2016</div>
                <a href="#" class="footer_post pb-4"> Success is not a good teacher failure makes you humble </a>
                <div class="footer_position_absolute"><img src="images/footer_sub_tipik.png" alt="img" class="width_footer_sub_img"/></div>
            </div>
            <div class="col-12 col-md-12 col-lg-4 ">
                <div class="footer_main_title py-3"> Last Modified Posts</div>
                <a href="#" class="footer_img_post_6"><img src="images/allef-vinicius-108153.jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/32-450x260.jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/download (1).jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/science-578x362.jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/vil-son-35490.jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/zack-minor-15104.jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/download.jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/download (2).jpg" alt="img"/></a>
                <a href="#" class="footer_img_post_6"><img src="images/ryan-moreno-98837.jpg" alt="img"/></a>
            </div> -->
        </div>
        
    </div>
</div>
<div class="container-fluid fh5co_footer_right_reserved">
    <div class="container">
        <div class="row  ">
            <div class="col-12 col-md-6 py-4 Reserved"> <a href="index.html" title="Free HTML5 Bootstrap templates"> nhóm 21</a>. </div>
            <div class="col-12 col-md-6 spdp_right py-4">
                <a href="index.html" class="footer_last_part_menu">trang chủ</a>
        </div>
    </div>
</div>

<div class="gototop js-top">
    <a href="#" class="js-gotop"><i class="fa fa-arrow-up"></i></a>
</div>
<!-- end footer -->
<!-- <div id ="footer-placeholder"></div> -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="js/owl.carousel.min.js"></script>
<!--<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"
        integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"
        integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"
        crossorigin="anonymous"></script>
<!-- Waypoints -->
<script src="js/jquery.waypoints.min.js"></script>
<!-- Main -->
<script src="js/main.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>

    <script>
    $(document).ready(function () {
        
        const apiUrl = "http://nguyenquocdai-001-site1.ltempurl.com/api/tin/danhsach";
        const menuApiUrl = "http://nguyenquocdai-001-site1.ltempurl.com/api/tin/menu";
        
        $("#header-placeholder").load("header.html");
        
       

        function renderArticles(articles, page) {
            const itemsPerPage = 6;
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const paginatedArticles = articles.slice(start, end);

            const newsContainer = $("#news-container");
            newsContainer.empty();

            paginatedArticles.forEach(article => {
                // console.log(article); 
                newsContainer.append(`
                    <div class="col-md-5">
                    <div class="fh5co_hover_news_img">
                        <div class="fh5co_news_img"><img src="${article.hinhDaiDien || 'https://via.placeholder.com/150'}" alt=""/></div>
                        <div>
                        <a href="single.html?idTin=${article.idTin || ''}" class="fh5co_magna py-2">${article.tieuDe || 'No Title'}</a> 
                        <a href="" class="fh5co_mini_time py-3"> ${article.tacGia || 'không có tác giả'}  - ${article.ngayDangTin || 'no time'}</a>
                        <div class="fh5co_consectetur"> ${article.moTa || 'chưa có mô tả cụ thể'}
                        </div>
                        </div>

                    </div>
                </div>

                    ` 
                );
            });
        }

        // menu
    function renderMenu(categories) {
    const menuContainer = $("#menu-container");
    menuContainer.empty(); // Clear existing menu items

    categories.forEach(category => {
        const subMenuItems = category.loaiTin.map(loai => `
            <li><a class="dropdown-item" href="#" data-id-loai-tin="${loai.idLoaiTin}">${loai.tenLoaiTin}</a></li>
        `).join("");

        menuContainer.append(`
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" data-id-nhom-tin="${category.idNhomTin}">
                    ${category.tenNhomTin}
                </a>
                <ul class="dropdown-menu">
                    ${subMenuItems}
                </ul>
            </li>
        `);
    });

    // Add hover event to show/hide dropdown
    $(".nav-item.dropdown").hover(
        function() {
            $(this).find(".dropdown-menu").stop(true, true).slideDown(200);
        },
        function() {
            $(this).find(".dropdown-menu").stop(true, true).slideUp(200);
        }
    );

    // Add click event for filtering articles based on loaiTin
    $(".dropdown-item[data-id-loai-tin]").click(function(e) {
        e.preventDefault();
        const idLoaiTin = $(this).data("id-loai-tin");
        // Fetch articles for selected idLoaiTin
        fetchArticlesByCategory(idLoaiTin);
    });
}

 // Hàm lọc bài viết theo idLoaiTin
function fetchArticlesByCategory(idLoaiTin) {
    const loaiTinApiUrl = "http://nguyenquocdai-001-site1.ltempurl.com/api/tin/loaitin/";

    $.getJSON(menuApiUrl, function(data) { 
        if (data) {
           
            // Lấy tất cả các bài viết từ API dựa vào idLoaiTin
            $.getJSON(`${loaiTinApiUrl}${idLoaiTin}`, function(articles) {
                console.log(articles);  
                
                // Lưu bài viết đã lọc vào biến toàn cục
                window.filteredArticles = articles;
                
                // Hiển thị các bài viết đã lọc và phân trang
                renderArticles(filteredArticles, 1);
                renderPagination(filteredArticles.length, 1);
            }).fail(function() {
                console.error("Failed to fetch articles for idLoaiTin:", idLoaiTin);
            });
        } else {
            console.error("Category not found for idLoaiTin:", idLoaiTin);
        }
    }).fail(function() {
        console.error("Failed to fetch menu categories.");
    });
}
        
    function renderPagination(totalArticles, currentPage) {
    const itemsPerPage = 6;
    const totalPages = Math.ceil(totalArticles / itemsPerPage);
    const pagination = $("#pagination");
    pagination.empty();

    // Previous button
    pagination.append(`
        <a href="#" class="btn_mange_pagging ${currentPage === 1 ? 'disabled' : ''}">
            <i class="fa fa-long-arrow-left"></i>&nbsp;&nbsp;Previous
        </a>
    `);

    // Page numbers with ellipsis if needed
    for (let i = 1; i <= totalPages; i++) {
        pagination.append(`
            <a href="#" class="btn_pagging ${i === currentPage ? 'active' : ''}">${i}</a>
        `);
    }

    // Next button
    pagination.append(`
        <a href="#" class="btn_mange_pagging ${currentPage === totalPages ? 'disabled' : ''}">
            Next&nbsp;&nbsp;<i class="fa fa-long-arrow-right"></i>
        </a>
    `);

    // Attach event listeners to pagination buttons
    $(".btn_pagging").click(function(e) {
        e.preventDefault();
        const page = parseInt($(this).text());
        renderArticles(window.filteredArticles, page);  // Render articles based on page
        renderPagination(window.filteredArticles.length, page);  // Re-render pagination
    });

    $(".btn_mange_pagging").click(function(e) {
        e.preventDefault();
        if ($(this).hasClass('disabled')) return;  // Prevent click if disabled

        let newPage = currentPage;
        if ($(this).find("i").hasClass("fa-long-arrow-left")) {
            newPage = currentPage - 1;
        } else {
            newPage = currentPage + 1;
        }

        if (newPage >= 1 && newPage <= totalPages) {
            renderArticles(window.filteredArticles, newPage);  // Render articles based on new page
            renderPagination(window.filteredArticles.length, newPage);  // Re-render pagination
        }
    });
}

        // Fetch all articles initially đọc hết tinh tức 
        $.getJSON(apiUrl, function(data) {
            window.articles = data; // Store articles globally
            window.filteredArticles = data; // Initially, all articles are displayed
            renderArticles(data, 1);
            renderPagination(data.length, 1);
        }).fail(function() {
            console.error("Failed to fetch articles from the API.");
        });
        
        // đọc lấy api menu 
        $.getJSON(menuApiUrl, function(data) {
            if (data && data.length > 0) {
                renderMenu(data); // Populate the menu dynamically
            } else {
                console.error("No categories found in the API response.");
            }
        }).fail(function(jqXHR, textStatus, errorThrown) {
            console.error("Failed to fetch menu categories:", textStatus, errorThrown);
            alert("Không thể tải menu danh mục. Vui lòng thử lại sau!");
        });

        // tìm kím  
        const searchInput = document.getElementById("search");
        const suggestionsList = document.getElementById("suggestions");

    });
    
</script>

</body>
</html>